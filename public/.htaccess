# CodeIgniter 4 - Public Folder .htaccess

# Disable directory browsing
Options -Indexes

# Set default index file
DirectoryIndex index.php index.html

# Enable rewrite engine
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Redirect trailing slashes
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)/$ /$1 [L,R=301]

    # Rewrite requests to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule>

# Deny access to sensitive files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

<FilesMatch "(^composer\.|^phpunit\.|\.env$)">
    Require all denied
</FilesMatch>

# PHP settings for mod_php (Apache Module)
<IfModule mod_php.c>
    php_flag display_errors Off
    php_value upload_max_filesize 64M
    php_value post_max_size 64M
    php_value max_execution_time 300
    php_value memory_limit 256M
</IfModule>

# Session configuration - Moved to .user.ini for PHP-FPM compatibility
# Note: .user.ini file should contain these settings for PHP-FPM:
# session.cookie_secure = 1
# session.cookie_httponly = 1
# session.cookie_samesite = "Lax"
# session.gc_probability = 1
# session.gc_divisor = 100
# session.gc_maxlifetime = 7200

# PHP settings for PHP-FPM/CGI (cPanel default)
# Session settings removed to prevent conflicts with CodeIgniter's ini_set()
# CodeIgniter will handle session configuration via app/Config/Session.php
